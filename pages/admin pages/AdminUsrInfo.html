---
layout: default
permalink: /admin/usrinfo
---
<style>
.closebtn {
  margin-left: 15px;
  color: white;
  font-weight: bold;
  float: right;
  font-size: 22px;
  line-height: 20px;
  cursor: pointer;
  transition: 0.3s;
}

.closebtn:hover {
  color: black;
}
  .delbtn{
    float: right;
  }
</style>
<body>
<div class="flex">
  <input type="text" enctype="multipart/form-data" placeholder="Name" name="name" id="name" list="names" autocomplete="off">
    <datalist id="names">
    </datalist>

</div>

<button id="loadinfo">Load Data</button>
  
  <div class="alert" id="alert">
  <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span> 
      <p id="message"></p>
</div>

 <div id="usrform" style="display: none;">
    <label for="fname"><b>First Name</b></label>
    <input type="text" placeholder="First Name" name="fname" id="fname" readonly>
    
    <label for="lname"><b>Last Name</b></label>
    <input type="text" placeholder="Last Name" name="lname" id="lname" readonly>
    
    <label for="email"><b>Email</b></label>
    <input type="text" placeholder="Email" name="email" id="email" readonly>
   
   <label for="date"><b>Last Attendance</b></label>
    <input type="text" placeholder="Last User Attendance" name="date" id="date" readonly>
    
   <span class="avoidwrap">
    <label for="cshs"><b>Part of CSHS</b></label>
    <input type="checkbox" name="cshs" id="cshs" value="CSHS_Member" disabled>
   </span>
     <span class="avoidwrap">
    <label for="admin"><b>Has Admin Privileges</b></label>
    <input type="checkbox" name="admin" id="adminss" value="ADMIN" disabled>
   </span><br>
         <button type="button" class="cancelbtn delbtn">Delete User</button>
   <br>

  </div>
  
  <!-- Delete Usr Modal !-->
  
  <div id="id02" class="modal">  
  <div class="modal-content animate" id="deleusr">
      <div class="exitcontainer">
        <span onclick="document.getElementById('id02').style.display='none'" class="close" title="Close Modal">&times;</span>
      </div>
    <div class="container">
      <p> To delete a user, type "DELETE" into the text box and press enter. Then press the Delete User button.
          <input type="text" placeholder="" name="delconf" id="delconf" pattern="[DELETE]{6}" required>
      </div>
   <button id="delbtnconf" onclick= "">Delete User</button>
  </div>
<div class="container" style="background-color:#f1f1f1">
      <button type="button" onclick="document.getElementById('id01').style.display='none'" class="cancelbtn">Cancel</button>
    </div>
  </div>
<script type = "text/javascript">
  
function getCookie(cname) {
  let name = cname + "=";
  let decodedCookie = decodeURIComponent(document.cookie);
  let ca = decodedCookie.split(';');
  for(let i = 0; i <ca.length; i++) {
    let c = ca[i];
    while (c.charAt(0) == ' ') {
      c = c.substring(1);
    }
    if (c.indexOf(name) == 0) {
      return c.substring(name.length, c.length);
    }
  }
  return "";
}

function loadUser(){  
  var inp = document.getElementById("name").value.toLowerCase();
  var dummy = "";
  
  for (var i = 0; i < res.length; i++){
    dummy = res[i].first_name + " " + res[i].last_name;
    if (inp == dummy.toLowerCase()){
      
      
      document.getElementById("usrform").style.display = "block";
      document.getElementById("alert").style.display = "none";
      
      
       document.getElementById("fname").value = res[i].first_name;
       document.getElementById("lname").value = res[i].last_name;
       document.getElementById("email").value = res[i].email;
       document.getElementById("date").value = new Date(res[i].login_date).toLocaleString();

       if (res[i].cshs == "CSHS_Member"){
       document.getElementById("cshs").checked = true
       }else{document.getElementById("cshs").checked = false}
       if (res[i].user_type == "ADMIN"){
       document.getElementById("adminss").checked = true
       } else{document.getElementById("adminss").checked = false}
      return;
      
    }else {
      document.getElementById("usrform").style.display = "none";
      document.getElementById("alert").style.display = "block";
      document.getElementById("message").innerHTML = "That user does not exist.";
    }
  }
}
function alerts(message){
   var x = document.getElementById("message");
  var popup = document.getElementById("alert");
  popup.style.display='block';
  x.innerHTML = message;
}
document.getElementById("delbtnconf").disabled = true;
  var myHeaders = new Headers();
myHeaders.append("token", getCookie("User"));
 
var requestOptions = {
  method: 'GET',
  headers: myHeaders,
  redirect: 'follow'
};
 var res = "";
fetch("https://computerclub.duckdns.org/admin/users", requestOptions)
  .then(async response => {var rese = response.headers.get('content-type')?.includes('application/json') ? await response.json() : null;
    res = rese.data;
                           
    if (res.error != null){
        alerts(res.error);
        return;
        }
    var dumdum = "";
    var dudummm = atob('YWxleEBnbWFpbC5jb20=').split(",");
    var dup = [];
                           console.log(dudummm);
    for (var i = 0; i < res.length; i++){
          var tr = 1;
      for (var o=0;o<dudummm.length;o++){if(res[i].email.normalize() == dudummm[o].normalize()){tr = 0; dup.push(i)}};
      if (tr == 1){
      dumdum = res[i].first_name + " " + res[i].last_name;
      var elementname = document.createElement("option");
      elementname.value = dumdum;
      var card = document.getElementById("names")
      card.appendChild(elementname);
      }
    };
     for(var i=dup.length-1;i>=0;i--){res.splice(dup[i],1)};   
     dup = [];
  })
  .catch(error => {console.log('error', error);
      alerts("There has been a connection error. Check console for more info.");
                 });
  
     document.getElementById("loadinfo").addEventListener("click", loadUser);
 var input = document.getElementById("name");
   input.addEventListener("keydown", function (e) {
    if (e.key === "Enter") {  
      loadUser();
    }
  });
  var input = document.getElementById("delconf");
   input.addEventListener("keydown", function (e) {
    if (e.key === "Enter") {  
      if (document.getElementById("delconf") === "DELETE"){
      document.getElementById("delbtnconf").disabled = false;
      }
    }
  });
</script>
</body>
